

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <link rel="icon" href='https://static.dionysus.zip/static/favicon.ico' type="image/x-icon">
    <title>A PHP Issue - MoonlitSyntax</title>

    <link rel="stylesheet" href='https://static.dionysus.zip/static/css/app-GERNH3ZV.css'>


    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
</head>

<body class="l-body">

<nav class="c-nav">
    <a href="/" class="c-nav__link">首页</a>
    <a href="/archives" class="c-nav__link">归档</a>
    <a href="/tags" class="c-nav__link">标签</a>
    <a href="/categories" class="c-nav__link">分类</a>
    <a href="/links" class="c-nav__link">友链</a>
    <a href="/about" class="c-nav__link">关于</a>
    <button id="search-button" class="c-nav__search-btn">
        <i class="fas fa-search"></i>
    </button>
</nav>


<div class="l-container">
    <div class="l-nav-spacer"></div>
    <main class="l-main">
        
<div class="c-post">
    <aside class="c-post__toc">
        <h2 class="c-post__toc-title">目录</h2>
        
        <div class="c-post__toc-empty">
            <i class="fas fa-info-circle"></i> 本文暂无小节
        </div>
        
    </aside>
    <div class="c-post__main">
        <header class="c-post__header">
            <h1 class="c-post__title">A PHP Issue</h1>
            <div class="c-post__meta">
                <span class="c-post__meta-create"><i class="fas fa-calendar-plus"></i> 创建：2023-11-14 22:21</span>
                <span class="c-post__meta-updated"><i class="fas fa-calendar-check"></i> 更新：2023-11-14 22:21</span>
                <span class="c-post__meta-category"><i class="fas fa-folder-open"></i> 分类：<a href="/categories/funny"><strong>funny</strong></a></span>
            </div>
            <div class="c-post__tags">
                <a href="/tags/PHP" class="c-post__tag">#PHP</a>
            </div>
            <div class="c-post__description">
                zip
            </div>
        </header>

        <article class="c-post__content prose"><p>PHP的<code>addGlob</code>的<code>remove_path</code>有一点点问题</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang">php</div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content" data-lang="php"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$zip</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ZipArchive</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$filename</span> <span class="o">=</span> <span class="s2">&#34;./test.zip&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">open</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="nx">ZipArchive</span><span class="o">::</span><span class="na">CREATE</span><span class="p">)</span><span class="o">!==</span><span class="k">TRUE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">exit</span><span class="p">(</span><span class="s2">&#34;无法打开 &lt;</span><span class="si">$filename</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$dev_dir</span> <span class="o">=</span> <span class="s1">&#39;/test/a.p&#39;</span><span class="p">;</span> <span class="c1">// 设置 remove_path
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 使用 addGlob 添加文件
</span></span></span><span class="line"><span class="cl"><span class="c1">//$zip-&gt;addGlob(&#39;/test/test/test/.htaccess&#39;, 0, [&#39;add_path&#39; =&gt; &#39;var/www/html/&#39;, &#39;remove_path&#39; =&gt; $dev_dir]);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">addGlob</span><span class="p">(</span><span class="s1">&#39;/test/test/a.php&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;add_path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;var/www/html/&#39;</span><span class="p">,</span> <span class="s1">&#39;remove_path&#39;</span> <span class="o">=&gt;</span> <span class="nv">$dev_dir</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//$zip-&gt;addGlob(&#39;/test/test/.htaccess&#39;, 0, [&#39;add_path&#39; =&gt; &#39;var/www/html/&#39;, &#39;remove_path&#39; =&gt; $dev_dir]);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">close</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">open</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span> <span class="o">===</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$extractPath</span> <span class="o">=</span> <span class="s1">&#39;/test&#39;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">extractTo</span><span class="p">(</span><span class="nv">$extractPath</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">close</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$files</span> <span class="o">=</span> <span class="nx">scandir</span><span class="p">(</span><span class="nv">$extractPath</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nv">$file</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;无法打开 &lt;</span><span class="si">$filename</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></div><p><div class="c-img" data-full="https://static.dionysus.zip/static/z-img/Pasted%20image%2020231113162752.png"><div class="c-img__ph"><div class="c-spinner"></div></div><img src="https://static.dionysus.zip/static/z-img/Pasted%20image%2020231113162752.png" alt="" loading="lazy" decoding="async" referrerpolicy="no-referrer" class="c-img__img"></div></p>
<p>由于设置的是<code>/test/a.p</code>,原始<code>/test/test/a.php</code>,最后结果<code>/t/a.php</code>
移除了<code>/test/tes</code>这与设置的<code>remove_path</code>长度相同
(不是移除,是指针 )</p>
<p>需要注意的是,只能有唯一的串,如果是多次出现的就没有这个效果了</p>
<p>正如源码里所展示的这样,addGlob展示的<code>remove_path</code>是去除前缀
<code>public ZipArchive::addGlob(string $pattern, int $flags = 0, array $options = []): array|false</code></p>
<p>然而实际上我发现匹配的是整个文件名的内容</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang">c</div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content" data-lang="c"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="k">if</span> <span class="p">((</span><span class="n">zval_file</span> <span class="o">=</span> <span class="n">zend_hash_index_find</span><span class="p">(</span><span class="n">Z_ARRVAL_P</span><span class="p">(</span><span class="n">return_value</span><span class="p">),</span> <span class="n">i</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span> <span class="p">(</span><span class="n">opts</span><span class="p">.</span><span class="n">remove_all_path</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="n">basename</span> <span class="o">=</span> <span class="n">php_basename</span><span class="p">(</span><span class="n">Z_STRVAL_P</span><span class="p">(</span><span class="n">zval_file</span><span class="p">),</span> <span class="n">Z_STRLEN_P</span><span class="p">(</span><span class="n">zval_file</span><span class="p">),</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">					<span class="n">file_stripped</span> <span class="o">=</span> <span class="n">ZSTR_VAL</span><span class="p">(</span><span class="n">basename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">					<span class="n">file_stripped_len</span> <span class="o">=</span> <span class="n">ZSTR_LEN</span><span class="p">(</span><span class="n">basename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">opts</span><span class="p">.</span><span class="n">remove_path</span> <span class="o">&amp;&amp;</span> <span class="n">strstr</span><span class="p">(</span><span class="n">Z_STRVAL_P</span><span class="p">(</span><span class="n">zval_file</span><span class="p">),</span> <span class="n">opts</span><span class="p">.</span><span class="n">remove_path</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="k">if</span> <span class="p">(</span><span class="n">IS_SLASH</span><span class="p">(</span><span class="n">Z_STRVAL_P</span><span class="p">(</span><span class="n">zval_file</span><span class="p">)[</span><span class="n">opts</span><span class="p">.</span><span class="n">remove_path_len</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">						<span class="n">file_stripped</span> <span class="o">=</span> <span class="n">Z_STRVAL_P</span><span class="p">(</span><span class="n">zval_file</span><span class="p">)</span> <span class="o">+</span> <span class="n">opts</span><span class="p">.</span><span class="n">remove_path_len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">						<span class="n">file_stripped_len</span> <span class="o">=</span> <span class="n">Z_STRLEN_P</span><span class="p">(</span><span class="n">zval_file</span><span class="p">)</span> <span class="o">-</span> <span class="n">opts</span><span class="p">.</span><span class="n">remove_path_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">						<span class="n">file_stripped</span> <span class="o">=</span> <span class="n">Z_STRVAL_P</span><span class="p">(</span><span class="n">zval_file</span><span class="p">)</span> <span class="o">+</span> <span class="n">opts</span><span class="p">.</span><span class="n">remove_path_len</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">						<span class="n">file_stripped_len</span> <span class="o">=</span> <span class="n">Z_STRLEN_P</span><span class="p">(</span><span class="n">zval_file</span><span class="p">)</span> <span class="o">-</span> <span class="n">opts</span><span class="p">.</span><span class="n">remove_path_len</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">					<span class="p">}</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="n">file_stripped</span> <span class="o">=</span> <span class="n">Z_STRVAL_P</span><span class="p">(</span><span class="n">zval_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">					<span class="n">file_stripped_len</span> <span class="o">=</span> <span class="n">Z_STRLEN_P</span><span class="p">(</span><span class="n">zval_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span></code></pre></div></div><p>而当指定的<code>remove_path</code>是文件路径后半段中的某些部分的时候,指针也会做移动,然而这是错误的,因此我们得到了一个奇怪的答案,这里我们演示一下</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang">bash</div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content" data-lang="bash"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">/tmp
</span></span><span class="line"><span class="cl">├── Dire
</span></span><span class="line"><span class="cl">│   └── This_Is_A_File
</span></span><span class="line"><span class="cl">└── test.php
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">2</span> directories, <span class="m">2</span> files
</span></span></code></pre></div></div><p>代码如下</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang">php</div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content" data-lang="php"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$zip</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ZipArchive</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$filename</span> <span class="o">=</span> <span class="s2">&#34;./HereIsZip.zip&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">open</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="nx">ZipArchive</span><span class="o">::</span><span class="na">CREATE</span><span class="p">)</span><span class="o">!==</span><span class="k">TRUE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">exit</span><span class="p">(</span><span class="s2">&#34;Wrong!!!</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dir</span> <span class="o">=</span> <span class="s1">&#39;/tmp/Dire&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$FirstDir</span> <span class="o">=</span> <span class="s1">&#39;/Dire/&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$SecondDir</span> <span class="o">=</span> <span class="s1">&#39;This_Is&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$ThirdDir</span> <span class="o">=</span> <span class="s1">&#39;/D&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">addGlob</span><span class="p">(</span><span class="s1">&#39;/tmp/Dire/This_Is_A_File&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;add_path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;remove_path&#39;</span> <span class="o">=&gt;</span> <span class="nv">$FirstDir</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">addGlob</span><span class="p">(</span><span class="s1">&#39;/tmp/Dire/This_Is_A_File&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;add_path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;remove_path&#39;</span> <span class="o">=&gt;</span> <span class="nv">$SecondDir</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">addGlob</span><span class="p">(</span><span class="s1">&#39;/tmp/Dire/This_Is_A_File&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;add_path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;remove_path&#39;</span> <span class="o">=&gt;</span> <span class="nv">$ThirdDir</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">addGlob</span><span class="p">(</span><span class="s1">&#39;/tmp/Dire/This_Is_A_File&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;add_path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;remove_path&#39;</span> <span class="o">=&gt;</span> <span class="nv">$dir</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">close</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">open</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span> <span class="o">===</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$extractPath</span> <span class="o">=</span> <span class="s1">&#39;/tmp&#39;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">extractTo</span><span class="p">(</span><span class="nv">$extractPath</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$zip</span><span class="o">-&gt;</span><span class="na">close</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;Wrong</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></div><p>运行<code>php test.php</code>
结果是</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang">bash</div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content" data-lang="bash"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">/tmp
</span></span><span class="line"><span class="cl">├── Dire
</span></span><span class="line"><span class="cl">│   └── This_Is_A_File
</span></span><span class="line"><span class="cl">├── HereIsZip.zip
</span></span><span class="line"><span class="cl">├── ire
</span></span><span class="line"><span class="cl">│   └── This_Is_A_File
</span></span><span class="line"><span class="cl">├── mp
</span></span><span class="line"><span class="cl">│   └── Dire
</span></span><span class="line"><span class="cl">│       └── This_Is_A_File
</span></span><span class="line"><span class="cl">├── re
</span></span><span class="line"><span class="cl">│   └── This_Is_A_File
</span></span><span class="line"><span class="cl">├── test.php
</span></span><span class="line"><span class="cl">└── This_Is_A_File
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">6</span> directories, <span class="m">7</span> files
</span></span></code></pre></div></div><p>我想结果非常显然</p>
<div class="c-code"><div class="c-code__header"><div class="c-code__dots"><span class="red"></span><span class="yellow"></span><span class="green"></span></div><div class="c-code__lang">php</div><div class="c-code__actions"><button class="c-code__btn c-code__btn--copy" title="Copy code"><i class="fas fa-copy"></i></button><button class="c-code__btn c-code__btn--fold" title="Fold code"><i class="fas fa-chevron-up"></i></button></div></div><div class="c-code__content" data-lang="php"><pre tabindex="0" class="chroma"><code><span class="line"><span class="cl"><span class="nv">$dir</span> <span class="o">=</span> <span class="s1">&#39;/tmp/Dire&#39;</span> <span class="c1">//正常结果,This_Is_A_File
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$FirstDir</span> <span class="o">=</span> <span class="s1">&#39;/Dire/&#39;</span><span class="p">;</span> <span class="c1">//结果是, ire/This_Is_A_File
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$SecondDir</span> <span class="o">=</span> <span class="s1">&#39;This_Is&#39;</span><span class="p">;</span><span class="c1">//结果是 re/This_Is_A_File
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$ThirdDir</span> <span class="o">=</span> <span class="s1">&#39;/D&#39;</span><span class="p">;</span><span class="c1">//结果是 mp/Dire/This_Is_A_File
</span></span></span></code></pre></div></div><p>给了点修复意见</p>
<p><div class="c-img" data-full="https://static.dionysus.zip/static/z-img/Pasted%20image%2020231114160912.png"><div class="c-img__ph"><div class="c-spinner"></div></div><img src="https://static.dionysus.zip/static/z-img/Pasted%20image%2020231114160912.png" alt="" loading="lazy" decoding="async" referrerpolicy="no-referrer" class="c-img__img"></div></p>
</article>

        <nav class="c-post__nav">
            
            <a href="/post/sprb%e6%94%bb%e7%95%a5" class="c-post__nav-card c-post__nav-card--prev">
                <h3>‹ 上一篇</h3>
                <p class="c-post__nav-title">sprb</p>
            </a>
            

            
            <a href="/post/spirit-2023" class="c-post__nav-card c-post__nav-card--next">
                <h3>下一篇 ›</h3>
                <p class="c-post__nav-title">Spirit-2023</p>
            </a>
            
        </nav>
    </div>
</div>

    </main>
    <footer class="c-footer">
        <span id="jinrishici-sentence" class="c-footer__quote">今日诗词加载中....</span>
        <div class="c-footer__copy">
            Copyright © <span id="currentYear">2025</span> Dionysus. All rights reserved.
        </div>
    </footer>
</div>

<div id="algolia-search-mask" class="c-search-mask"></div>
<div id="algolia-search-modal" class="c-search-modal">
    <div class="c-search-modal__box">
        <div class="c-search-modal__header">搜索</div>
        <div class="c-search-modal__summary" id="algolia-search-summary" style="display:none;">共找到 0 条结果</div>
        <input type="text" id="algolia-search-input" class="c-search-modal__input" placeholder="请输入关键词..." />
        <div id="algolia-search-results" class="c-search-modal__results"></div>
        <div id="algolia-pagination" class="c-search-modal__pagination"></div>
        <hr class="c-search-modal__divider" />
    </div>
</div>

<script src='https://static.dionysus.zip/static/js/app-IJHRYWUS.js' defer></script>


<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js" defer></script>
<script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8" defer></script>
</body>
</html>

